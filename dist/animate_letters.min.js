/**
 * ~~~ ANIMATE LETTERS JS ~~~
 *
 * Script for wrap letters of a text with a <span> tag
 * and add or remove CSS classes from thoses spans tags.
 *
 * Copyright: Raphaël Castello, 2023
 * Web/contact: www.sns.pm
 * License: GNU AGPL (open source)
 * Script: animate_letters.min.js
 * Version: 2.0.0
 * GitHub: https://github.com/Raf-sns/Animate-Letters-JS
 * Minified by Code Beautify: https://codebeautify.org/minify-js#
 */
const animate_letters=(e,t)=>(this.error=!1,document.body.contains(document.querySelector(e))||(console.error("Animate letters : Element "+e+" is not defined, check please ..."),this.error=!0),t&&void 0!==t.add&&void 0!==t.remove||(console.error("Animate letters : Please, provide an object of Options"),this.error=!0),t.add.length!=t.remove.length&&(console.error("Animate letters : Please, provide the same number of arrays for adding and removing phases"),this.error=!0),this.element_memorized="",this.memorize_element=()=>{this.element_memorized=document.querySelector(e).outerHTML},this.hide_element_before=()=>{document.querySelector(e).style.visibility="hidden"},this.text_memorized="",this.prepare=()=>{this.memorize_element(),1==t.hide_element_before&&this.hide_element_before();var i=document.querySelector(e).innerHTML;this.text_memorized=i;var s=(i=(i=i.replaceAll(/(<br>)|(<br\/>)/gm,"ø")).replaceAll(/(&amp;)/gm,"&")).trim().split(""),r="";s.forEach(((e,i)=>{"ø"==e?r+="<br/>":" "==e?r+=e:0!=t.prepare.length?r+='<span class="'+t.prepare+'">'+e+"</span>":r+="<span>"+e+"</span>"})),document.querySelector(e).innerHTML=r},this.Letters=[],this.Indx=0,this.stop=!1,this.run=()=>{if(!this.error){1==t.hide_element_before&&(document.querySelector(e).style.visibility="visible"),void 0===t.timers[this.Indx]||void 0===t.timers[this.Indx].delay?this.delay_time=0:(this.delay_time=0,this.delay_time+=t.timers[this.Indx].delay),void 0===t.timers[this.Indx]||void 0===t.timers[this.Indx].increment_delay?(this.increment_delay=100,console.info("Animate letters : No value found for the timer of this phase, the default value was used")):this.increment_delay=t.timers[this.Indx].increment_delay,this.Letters=document.querySelectorAll(e+" span");var i=[];for(const[e,s]of this.Letters.entries()){if(1==this.stop){window.clearTimeout(i[e-1]),this.Indx=0,this.Letters=[];break}i[e]=window.setTimeout((function(){if(void 0!==t.add[this.Indx]&&void 0!==t.remove[this.Indx]){if(1==this.stop)return window.clearTimeout(i[e]),this.Indx=0,void(this.Letters=[]);void 0!==t.add[this.Indx]&&0!=t.add[this.Indx].length&&s.classList.add(...t.add[this.Indx]),void 0!==t.remove[this.Indx]&&0!=t.remove[this.Indx].length&&s.classList.remove(...t.remove[this.Indx]),e==this.Letters.length-1&&(this.Indx++,this.end()),window.clearTimeout(i[e])}}),this.delay_time),this.delay_time+=this.increment_delay}}},this.end=()=>{var e=this.Letters.length-1;if(1==this.stop)return this.Indx=0,this.Letters=[],this.Letters[e].ontransitioncancel=()=>{},void(this.Letters[e].onanimationcancel=()=>{});void 0===t.timers[this.Indx]||void 0===t.timers[this.Indx].delay?this.phase_delay=0:(this.phase_delay=0,this.phase_delay+=t.timers[this.Indx].delay);var i=[];this.Indx<=t.add.length-1?i[this.Indx]=window.setTimeout((function(){this.run(),window.clearTimeout(i[this.Indx])}),this.phase_delay):(this.Letters[e].ontransitionend=()=>{"function"==typeof t.end_callBack&&t.end_callBack(),this.remove_spans()},this.Letters[e].onanimationend=()=>{"function"==typeof t.end_callBack&&t.end_callBack(),this.remove_spans()})},this.remove_spans=()=>{0!=t.clean_after&&(document.querySelector(e).innerHTML=this.text_memorized)},this.re_init=()=>{this.stop=!0,this.Indx=0,this.Letters=[],document.querySelector(e).outerHTML=this.element_memorized,1==t.hide_element_before&&this.hide_element_before(),this.prepare(),this.stop=!1},this.prepare(),this);
